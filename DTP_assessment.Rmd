---
title: "data_translation_project"
author: "Tamlyn Tamura"
date: "2/21/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown
Loading libraries
Ctrl + Alt + I for new code chunks

```{r libraries, include=FALSE}
library(tidyverse)
library(jtools)
library(car)
library(vtable)
library(purrr)
```

Read in data

```{r data, include = FALSE}
id_name_link <- read_csv("Lab3_Rawdata/id_name_link.csv")

Most_Recent_Cohorts_Scorecard_Elements_ <- read_csv("Lab3_Rawdata/Most+Recent+Cohorts+(Scorecard+Elements).csv")

trends <- list.files(path = 'Lab3_Rawdata', pattern = 'trends_up_to', full.names = TRUE) %>%
  map_dfr(read_csv)
```

This is where I take unstructured data and try to make it a bit easier to read. I linked 'unitid' and 'opeid' to create a unique key, in case it became more organized this way down the line. 

```{r data wranging, include = FALSE}
id_name_link <- id_name_link %>% distinct(schname, .keep_all = TRUE)
id_name_link <- id_name_link %>% unite(key, c('unitid', 'opeid'), sep = '_')


Most_Recent_Cohorts_Scorecard_Elements_ <- Most_Recent_Cohorts_Scorecard_Elements_ %>%
  unite(key, c('UNITID', 'OPEID'), sep = '_')


college_id <- left_join(id_name_link, Most_Recent_Cohorts_Scorecard_Elements_)
college_id <- separate(college_id, schname, into = 'college', sep = '-')
college_id <- college_id[!duplicated(college_id$'college'),] # Separated college from cities then removed colleges with same names
college_id <- filter(college_id, PREDDEG == '3') # Filter to only show colleges that predominantly grant bachelor's degrees


college_id_condensed <- select(college_id, c('key', 'college', 'INSTNM', 'STABBR', 'PREDDEG', 'md_earn_wne_p10-REPORTED-EARNINGS', 'LOCALE'))


college_trends <- full_join(college_id_condensed, trends) %>%
  group_by(college, .add = FALSE) %>%
  subset(monthorweek > "2015-08-23 - 2015-08-29") # Filter out data that's from before September 2015, before College Scorecard was released

```

Create new data sets separated by LOCALE type--typically urbanized/city areas have a higher market rate than rural and suburban/town areas. 

I was hesitant on whether or not I should include Rural Fringe, Rural Distant, and Rural Remote (41, 42, 43), since there aren't many colleges that would be in these areas, but this actually accounts for 6448 observations, so I have decided to leave those in.


```{r separate data sets, include = FALSE}


college_trends$`md_earn_wne_p10-REPORTED-EARNINGS` <- as.numeric(as.character(college_trends$`md_earn_wne_p10-REPORTED-EARNINGS`))
summary(college_trends)

# Urban data frame
urban_df <- filter(college_trends, LOCALE == 11 & 12 & 13)
summary(urban_df)


# Suburban data frame
suburban_df <- filter(college_trends, LOCALE == 21 & 22 & 23)
summary(suburban_df)


# Town data frame
town_df <- filter(college_trends, LOCALE == 31 & 32 & 33)
summary(town_df)


# Rural data frame
rural_df <- filter(college_trends, LOCALE == 41 & 42 & 43)
summary(rural_df)


```

Locale median: 42300
Locale mean: 43904

Urban min: 19800, 
Urban median: 46600
Urban mean: 47318
Urban max: 121500

Suburban min: 17600
Suburban median: 43900
Suburban mean: 45017
Suburban max: 166200

Town min: 28900
Town median: 39900
Town mean: 41275
Town max: 68500

Rural min: 21300
Rural median: 37800
Rural mean: 37375
Rural max: 59000

Urban environments mean there are more people, more infrastructure, more businesses, and a lot more money to go around, thus raising the market rate in the local area. Despite a couple of outliers, it was expected to notice that the more urbanized a college is located, the higher the mean and medians of the salary among those who graduated 10 years before (1. Urban, 2. Suburban, 3. Town, 4. Rural). 

Comparing these results to the median of total colleges across the board, I get a median 42300 USD and a mean of 43904 USD. These numbers are not too far off from the suburban mean and median, which is too be expected since there are significantly more colleges that predominantly grant bachelor's degrees (more observations) in the urban and suburban areas, as opposed to in town and rural areas.


```{r is it time for regressions?, include = FALSE}

# Realized md_earn_wne_pt10-REPORTED-EARNINGS was causing me problems while running my regressions due to the -
# Went back and renamed the variable for my 5 data frames (urban_df, suburban_df, town_df, rural_df, locale_df)
locale_df <- rename(college_trends, median_salary = 'md_earn_wne_p10-REPORTED-EARNINGS')
urban_df <- rename(urban_df, median_salary = 'md_earn_wne_p10-REPORTED-EARNINGS')
suburban_df <- rename(suburban_df, median_salary = 'md_earn_wne_p10-REPORTED-EARNINGS')
town_df <- rename(town_df, median_salary = 'md_earn_wne_p10-REPORTED-EARNINGS')
rural_df <- rename(rural_df, median_salary = 'md_earn_wne_p10-REPORTED-EARNINGS')


locale_reg <- lm(college_trends$index ~ college_trends$md_earn_wne_p10-REPORTED-EARNINGS, data = college_trends)

```

